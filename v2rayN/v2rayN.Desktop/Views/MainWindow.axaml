<Window
    x:Class="v2rayN.Desktop.Views.MainWindow"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="clr-namespace:ServiceLib.Models;assembly=ServiceLib"
    Title="Yvpn"
    Width="520"
    Height="760"
    MinWidth="460"
    MinHeight="680"
    FontFamily="Segoe UI, Inter, Noto Sans, Arial, sans-serif"
    Background="#0B0C11"
    SystemDecorations="None"
    ExtendClientAreaChromeHints="NoChrome"
    ExtendClientAreaTitleBarHeightHint="44"
    ExtendClientAreaToDecorationsHint="True"
    Icon="/Assets/favicon.ico"
    ShowInTaskbar="True"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">
    <Window.Resources>
        <SolidColorBrush x:Key="BaseBackground" Color="#0B0C11" />
        <SolidColorBrush x:Key="PanelBackground" Color="#131722" />
        <SolidColorBrush x:Key="PanelBorder" Color="#272B38" />
        <SolidColorBrush x:Key="PrimaryText" Color="#F4F5F7" />
        <SolidColorBrush x:Key="SecondaryText" Color="#A8AFBD" />
        <SolidColorBrush x:Key="AccentRed" Color="#C31845" />
        <SolidColorBrush x:Key="AccentRedSoft" Color="#E85B81" />
        <SolidColorBrush x:Key="AccentBlue" Color="#1778FF" />
    </Window.Resources>

    <Window.Styles>
        <Style Selector="Border.Card">
            <Setter Property="Background" Value="{StaticResource PanelBackground}" />
            <Setter Property="BorderBrush" Value="{StaticResource PanelBorder}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="Padding" Value="14" />
        </Style>

        <Style Selector="Button.WindowControl">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="Foreground" Value="#C9CEDA" />
            <Setter Property="Width" Value="42" />
            <Setter Property="Height" Value="32" />
            <Setter Property="FontSize" Value="17" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="CornerRadius" Value="8" />
        </Style>

        <Style Selector="Button.WindowControl:pointerover">
            <Setter Property="Background" Value="#222735" />
        </Style>

        <Style Selector="Button.WindowControl.close:pointerover">
            <Setter Property="Background" Value="#C31845" />
            <Setter Property="Foreground" Value="White" />
        </Style>

        <Style Selector="Button.PowerButton">
            <Setter Property="Width" Value="220" />
            <Setter Property="Height" Value="94" />
            <Setter Property="CornerRadius" Value="20" />
            <Setter Property="Background" Value="#121720" />
            <Setter Property="Foreground" Value="#E2E6EF" />
            <Setter Property="BorderBrush" Value="#2C3347" />
            <Setter Property="BorderThickness" Value="1" />
        </Style>

        <Style Selector="TextBlock.PowerBrand">
            <Setter Property="FontSize" Value="34" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="LetterSpacing" Value="0.8" />
            <Setter Property="Foreground" Value="#9AA3B5" />
        </Style>

        <Style Selector="TextBlock.PowerHint">
            <Setter Property="FontSize" Value="11" />
            <Setter Property="Foreground" Value="#717A8E" />
            <Setter Property="HorizontalAlignment" Value="Center" />
        </Style>

        <Style Selector="Button.ModeButton">
            <Setter Property="Height" Value="30" />
            <Setter Property="CornerRadius" Value="9" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Foreground" Value="#A7B0C2" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="0" />
        </Style>

        <Style Selector="Border.ModeToggleTrack">
            <Setter Property="Background" Value="#111724" />
            <Setter Property="BorderBrush" Value="#2C354A" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="Padding" Value="2" />
            <Setter Property="Height" Value="36" />
            <Setter Property="Width" Value="204" />
            <Setter Property="HorizontalAlignment" Value="Right" />
        </Style>

        <Style Selector="Button.PrimaryButton">
            <Setter Property="Height" Value="38" />
            <Setter Property="CornerRadius" Value="10" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="#FFF3F6" />
            <Setter Property="Background" Value="{StaticResource AccentRed}" />
            <Setter Property="BorderBrush" Value="{StaticResource AccentRedSoft}" />
            <Setter Property="BorderThickness" Value="1" />
        </Style>

        <Style Selector="Button.DangerButton">
            <Setter Property="Height" Value="38" />
            <Setter Property="CornerRadius" Value="10" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="#FBD6DF" />
            <Setter Property="Background" Value="#29111A" />
            <Setter Property="BorderBrush" Value="#4B2230" />
            <Setter Property="BorderThickness" Value="1" />
        </Style>

        <Style Selector="Button.LinkButton">
            <Setter Property="Height" Value="30" />
            <Setter Property="Padding" Value="10,0" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="Background" Value="#131826" />
            <Setter Property="BorderBrush" Value="#2A3550" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Foreground" Value="#6DB0FF" />
        </Style>

        <Style Selector="Expander.ConfigExpander">
            <Setter Property="Background" Value="#151C2A" />
            <Setter Property="BorderBrush" Value="#2D3650" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="12" />
        </Style>

        <Style Selector="Expander.ConfigExpander > Border">
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Background" Value="Transparent" />
        </Style>

        <Style Selector="ListBox.ConfigList">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="0" />
        </Style>

        <Style Selector="ListBox.ConfigList > ListBoxItem">
            <Setter Property="Padding" Value="0" />
            <Setter Property="Margin" Value="0" />
            <Setter Property="Background" Value="#161D2B" />
            <Setter Property="BorderBrush" Value="#263047" />
            <Setter Property="BorderThickness" Value="0,0,0,1" />
        </Style>

        <Style Selector="ListBox.ConfigList > ListBoxItem:pointerover">
            <Setter Property="Background" Value="#1B2638" />
        </Style>

        <Style Selector="ListBox.ConfigList > ListBoxItem:selected">
            <Setter Property="Background" Value="#0F4EA6" />
            <Setter Property="BorderBrush" Value="#2D74E9" />
        </Style>

        <Style Selector="Button.ConfigDeleteButton">
            <Setter Property="Width" Value="26" />
            <Setter Property="Height" Value="26" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="CornerRadius" Value="13" />
            <Setter Property="Background" Value="#192131" />
            <Setter Property="BorderBrush" Value="#32415F" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Foreground" Value="#D2DBEC" />
        </Style>

        <Style Selector="Button.ConfigDeleteButton:pointerover">
            <Setter Property="Background" Value="#2A1420" />
            <Setter Property="BorderBrush" Value="#8A2B48" />
            <Setter Property="Foreground" Value="#FFD2DD" />
        </Style>

        <Style Selector="Button.ConfigDeleteButton:pressed">
            <Setter Property="Background" Value="#170D14" />
            <Setter Property="BorderBrush" Value="#7B233F" />
        </Style>
    </Window.Styles>

    <Grid Background="{StaticResource BaseBackground}" RowDefinitions="44,*">
        <Border
            x:Name="topBar"
            Grid.Row="0"
            Background="#0E111A"
            BorderBrush="#1D2432"
            BorderThickness="0,0,0,1"
            PointerPressed="TopBar_PointerPressed">
            <Grid ColumnDefinitions="Auto,*,Auto" Margin="10,0,4,0">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Spacing="8">
                    <Image Width="20" Height="20" Source="/Assets/favicon.ico" />
                    <TextBlock Foreground="{StaticResource PrimaryText}" FontSize="13" FontWeight="SemiBold" Text="Yvpn" />
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center" Spacing="2">
                    <Button x:Name="btnMinimize" Classes="WindowControl" Content="-" />
                    <Button x:Name="btnMaximize" Classes="WindowControl" Content="□" />
                    <Button x:Name="btnClose" Classes="WindowControl close" Content="×" />
                </StackPanel>
            </Grid>
        </Border>

        <Grid Grid.Row="1">
            <ScrollViewer
                x:Name="scrollMainContent"
                HorizontalScrollBarVisibility="Disabled"
                VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="18,14,18,18" Spacing="12">
                    <Border x:Name="sectionMainCard" Classes="Card">
                        <StackPanel HorizontalAlignment="Center" Spacing="8">
                            <TextBlock
                                HorizontalAlignment="Center"
                                Foreground="{StaticResource PrimaryText}"
                                FontSize="31"
                                FontWeight="SemiBold"
                                Text="Yvpn" />
                            <TextBlock
                                HorizontalAlignment="Center"
                                Foreground="{StaticResource SecondaryText}"
                                Text="Время подключения" />
                            <TextBlock
                                x:Name="txtConnectionDuration"
                                HorizontalAlignment="Center"
                                Foreground="{StaticResource PrimaryText}"
                                FontSize="42"
                                FontWeight="SemiBold"
                                Text="00:00:00" />

                            <Button x:Name="btnToggleConnection" Classes="PowerButton">
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="1">
                                    <TextBlock x:Name="txtPowerBrand" Classes="PowerBrand" Text="Y-VPN" />
                                    <TextBlock x:Name="txtPowerHint" Classes="PowerHint" Text="нажмите для запуска" />
                                </StackPanel>
                            </Button>

                            <Border
                                x:Name="statusPill"
                                Padding="16,6"
                                Background="#1A1F2D"
                                BorderBrush="#32384A"
                                BorderThickness="1"
                                CornerRadius="999">
                                <TextBlock
                                    x:Name="txtConnectionStatus"
                                    HorizontalAlignment="Center"
                                    Foreground="#B4BBCB"
                                    FontWeight="SemiBold"
                                    Text="Не подключено" />
                            </Border>
                        </StackPanel>
                    </Border>

                    <Border x:Name="sectionModeCard" Classes="Card">
                        <StackPanel Spacing="8">
                            <TextBlock Foreground="{StaticResource PrimaryText}" FontSize="18" FontWeight="SemiBold" Text="Режим" />
                            <Border Classes="ModeToggleTrack">
                                <Grid>
                                    <Border
                                        x:Name="modeToggleThumb"
                                        Margin="2,2,0,2"
                                        HorizontalAlignment="Left"
                                        Background="#0F4EA6"
                                        CornerRadius="9"
                                        Width="98" />
                                    <Grid Margin="2" ColumnDefinitions="*,*">
                                        <Button x:Name="btnModeProxy" Grid.Column="0" Classes="ModeButton" Content="ПРОКСИ" />
                                        <Button x:Name="btnModeTun" Grid.Column="1" Classes="ModeButton" Content="ТУННЕЛЬ" />
                                    </Grid>
                                </Grid>
                            </Border>
                            <TextBlock
                                Foreground="#95A0B5"
                                FontSize="12"
                                Text="Системный прокси: подходит для браузеров и приложений, которые используют прокси ОС."
                                TextWrapping="Wrap" />
                            <TextBlock
                                Foreground="#95A0B5"
                                FontSize="12"
                                Text="Туннель: перехватывает весь трафик устройства через VPN."
                                TextWrapping="Wrap" />
                        </StackPanel>
                    </Border>

                    <Border x:Name="sectionConfigCard" Classes="Card">
                        <StackPanel Spacing="8">
                            <Button
                                x:Name="btnImportFromClipboard"
                                Classes="PrimaryButton"
                                Content="Добавить из буфера" />
                            <Expander
                                x:Name="expConfigs"
                                Classes="ConfigExpander"
                                ExpandDirection="Down"
                                IsExpanded="True">
                                <Expander.Header>
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            Foreground="{StaticResource PrimaryText}"
                                            FontSize="18"
                                            FontWeight="SemiBold"
                                            Text="КОНФИГУРАЦИИ" />
                                        <TextBlock
                                            x:Name="txtConfigsChevron"
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            Foreground="#6EA8FF"
                                            FontSize="18"
                                            FontWeight="SemiBold"
                                            Text="▾" />
                                    </Grid>
                                </Expander.Header>
                                <ListBox x:Name="lstConfigs" Classes="ConfigList" SelectionMode="Single">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate x:DataType="models:ComboItem">
                                            <Grid ColumnDefinitions="*,Auto">
                                                <TextBlock
                                                    Margin="12,10,8,10"
                                                    VerticalAlignment="Center"
                                                    Text="{Binding Text}"
                                                    TextWrapping="Wrap" />
                                                <Button
                                                    Grid.Column="1"
                                                    Margin="0,8,10,8"
                                                    Classes="ConfigDeleteButton"
                                                    Click="BtnDeleteConfigRow_Click"
                                                    Tag="{Binding ID}"
                                                    ToolTip.Tip="Удалить конфигурацию">
                                                    <PathIcon
                                                        Width="12"
                                                        Height="12"
                                                        Data="{StaticResource building_delete}"
                                                        Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" />
                                                </Button>
                                            </Grid>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </Expander>
                        </StackPanel>
                    </Border>

                    <Border Classes="Card">
                        <StackPanel Spacing="6">
                            <TextBlock Foreground="{StaticResource PrimaryText}" FontSize="18" FontWeight="SemiBold" Text="Статус" />
                            <TextBlock x:Name="txtRunningServerDisplay" Foreground="#D6DAE5" TextWrapping="Wrap" />
                            <TextBlock x:Name="txtRunningInfoDisplay" Foreground="#A6AFC1" FontSize="12" TextWrapping="Wrap" />
                            <TextBlock x:Name="txtSpeedProxyDisplay" Foreground="#8FB8FF" FontSize="12" TextWrapping="Wrap" />
                        </StackPanel>
                    </Border>

                    <Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="10">
                        <TextBlock VerticalAlignment="Center" Foreground="#8F98AB" Text="Yvpn" />
                        <Button x:Name="btnOpenTg" Grid.Column="1" Classes="LinkButton" Content="TG бот" />
                        <Button x:Name="btnOpenSite" Grid.Column="2" Classes="LinkButton" Content="yopen.ru" />
                    </Grid>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </Grid>
</Window>
